<!-- UI for Web App Security Analyzer -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Web App Security Analyzer</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <!-- Custom Styles -->
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container mt-5">
        <!-- ============================= -->
        <!-- Web App Security Analyzer UI -->
        <!-- ============================= -->
        <h1 class="mb-4">Web App Security Analyzer</h1>
        <!-- URL Input Form -->
        <form method="post">
            <div class="mb-3">
                <label for="url" class="form-label">Target URL</label>
                <input type="text" class="form-control" id="url" name="url" placeholder="https://example.com" required>
            </div>
            <button type="submit" class="btn btn-primary">Scan</button>
        </form>
        <!-- Error Message -->
        {% if error %}
            <div class="alert alert-danger mt-3">{{ error }}</div>
        {% endif %}
        <!-- Scan Results Section -->
        {% if result %}
        <hr>
        <h2>Scan Results for {{ result.url }}</h2>
        <!-- Security Headers Section -->
        <h4 class="mt-4">Security Headers</h4>
        <ul>
            {% for header, missing in result.headers.items() %}
                <li>{{ header }}: <span class="fw-bold {{ 'text-danger' if missing else 'text-success' }}">{{ 'Missing' if missing else 'Present' }}</span></li>
            {% endfor %}
        </ul>
        <!-- Vulnerability Detection Section -->
        <h4 class="mt-4">Vulnerability Detection</h4>
        <ul>
            <li>SQL Injection: <span class="fw-bold {{ 'text-danger' if result.sqli else 'text-success' }}">{{ 'Potentially Vulnerable' if result.sqli else 'No Pattern Detected' }}</span></li>
            <li>XSS: <span class="fw-bold {{ 'text-danger' if result.xss else 'text-success' }}">{{ 'Potentially Vulnerable' if result.xss else 'No Pattern Detected' }}</span></li>
            <li>CSRF Token in Forms: <span class="fw-bold {{ 'text-success' if result.csrf else 'text-danger' }}">{{ 'Present' if result.csrf else 'Missing' }}</span></li>
        </ul>
        {% endif %}
    </div>
</body>
</html>
